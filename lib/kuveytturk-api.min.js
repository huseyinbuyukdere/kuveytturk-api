!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("kuveytturk-api",[],t):"object"==typeof exports?exports["kuveytturk-api"]=t():e["kuveytturk-api"]=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"KuveytturkApi",{enumerable:!0,get:function(){return o.default}});var r,o=(r=n(1))&&r.__esModule?r:{default:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(2)),o=u(n(6));function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a="",s="",c="",f=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a=t,s=n,c=o}var t,n,u;return t=e,(n=[{key:"getCredentialsToken",value:function(){var e=this;if(r.isValidToken(this.token))return new Promise(function(t){t(e.token.access_token)});var t=[];t.push("public");var n=r.prepareClientCredentialsRequest(t,a,s);return new Promise(function(t,u){var i=r.prepareFetch(n);fetch(o.CLIENT_CREDENTIALS_URL,i).then(function(n){200!=n.status&&u(n.statusText),n.json().then(function(n){e.token={},e.token.access_token=n.access_token,e.token.expiresIn=n.expires_in,e.token.receivedTime=Date.now(),t(n.access_token)})})})}},{key:"fxCurrencyList",value:function(){}},{key:"fxCurrencyRates",value:function(){return this.sendGeneralGetRequest(o.FX_CURRENCY_RATES)}},{key:"kuveytTurkBranchList",value:function(){var e=this;return new Promise(function(t,n){e.getCredentialsToken().then(function(e){var u=r.prepareGeneralRequest(e,void 0,c),i=r.prepareFetch(u);fetch(o.KUVEYT_TURK_BRANCHES,i).then(function(e){200!=e.status&&n(e.statusText),e.json().then(function(e){t(e)})})})})}},{key:"kuveytTurkAtmList",value:function(){var e=this;return new Promise(function(t,n){e.getCredentialsToken().then(function(e){var u=r.prepareGeneralRequest(e,void 0,c),i=r.prepareFetch(u);fetch(o.KUVEYT_TURK_ATMS,i).then(function(e){200!=e.status&&n(e.statusText),e.json().then(function(e){t(e)})})})})}},{key:"kuveytTurkXtmList",value:function(){var e=this;return new Promise(function(t,n){e.getCredentialsToken().then(function(e){var u=r.prepareGeneralRequest(e,void 0,c),i=r.prepareFetch(u);fetch(o.KUVEYT_TURK_XTMS,i).then(function(e){200!=e.status&&n(e.statusText),e.json().then(function(e){t(e)})})})})}},{key:"bankList",value:function(){var e=this;return new Promise(function(t,n){e.getCredentialsToken().then(function(e){var u=r.prepareGeneralRequest(e,void 0,c),i=r.prepareFetch(u);fetch(o.BANK_LIST,i).then(function(e){200!=e.status&&n(e.statusText),e.json().then(function(e){t(e)})})})})}},{key:"bankBranchList",value:function(e,t){var n=this,u=o.BANK_LIST+"/"+e+"/branches",i="?cityId="+t,a=u+i;return new Promise(function(e,t){n.getCredentialsToken().then(function(n){var o=r.prepareGeneralRequest(n,void 0,c,i),u=r.prepareFetch(o);fetch(a,u).then(function(n){200!=n.status&&t(n.statusText),n.json().then(function(t){e(t)})})})})}},{key:"sendGeneralGetRequest",value:function(e,t){var n=this;return new Promise(function(o,u){n.getCredentialsToken().then(function(n){var i=r.prepareGeneralRequest(n,void 0,c,t),a=r.prepareFetch(i);fetch(e,a).then(function(e){200!=e.status&&u(e.statusText),e.json().then(function(e){o(e)})})})})}}])&&i(t.prototype,n),u&&i(t,u),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prepareClientCredentialsRequest=function(e,t,n){var u={body:"",headers:{}},i={grant_type:"client_credentials"};return i.scope=(0,r.arrayToString)(e),i.client_id=t,i.client_secret=n,u.headers=Object.assign({},u.headers,{"Content-Type":o.URL_ENCODED_TYPE}),u.body=(0,r.JSON_to_URLEncoded)(i),u},t.prepareGeneralRequest=u,t.prepareFetch=i,t.sendGeneralGetRequest=function(e,t,n){new Promise(function(r,o){n().then(function(n){var a=u(n,void 0,e),s=i(a);fetch(t,s).then(function(e){200!=e.status&&o(e.statusText),e.json().then(function(e){r(e)})})})})},t.isValidToken=function(e){if(!e)return!1;var t=Date.now();if((0,r.getSecondsBetweenDates)(t,e.receivedTime)<e.expiresIn)return!0};var r=n(3),o=n(5);function u(e,t,n,o){var u={body:"",headers:{}};return u.body="",t&&(u.body=JSON.stringify(t)),u.headers.Authorization="Bearer "+e,u.headers.Signature=(0,r.generateSignature)(e,u.body,n,o),u.headers=Object.assign({},u.headers,{"Content-Type":"application/json"}),u}function i(e){return e.body?{method:"POST",body:e.body,headers:e.headers}:{method:"GET",headers:e.headers}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayToString=function(e){var t="";return e.forEach(function(e){t+=e+" "}),t=t.substr(0,t.length-1)},t.JSON_to_URLEncoded=function e(t,n,r){r=r||[];if("object"==o(t))for(var u in t)e(t[u],n?n+"["+u+"]":u,r);else r.push(n+"="+encodeURIComponent(t));return r.join("&")},t.generateSignature=function(e,t,n,o){var u=e+t;o&&(u+=o);var i=r.createSign("RSA-SHA256");return i.write(u),i.end(),i.sign(n,"base64")},t.getSecondsBetweenDates=function(e,t){if(e>t)return(e-t)/1e3;return(t-e)/1e3};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(4));function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL_ENCODED_TYPE=void 0;t.URL_ENCODED_TYPE="application/x-www-form-urlencoded"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BANK_LIST=t.KUVEYT_TURK_XTMS=t.KUVEYT_TURK_ATMS=t.KUVEYT_TURK_BRANCHES=t.FX_CURRENCY_RATES=t.FX_CURRENCY_LIST=t.CLIENT_CREDENTIALS_URL=t.API_BASE_URL=t.IDENTITY_BASE_URL=void 0;t.IDENTITY_BASE_URL="https://idprep.kuveytturk.com.tr";var r="https://apitest.kuveytturk.com.tr/prep";t.API_BASE_URL=r;t.CLIENT_CREDENTIALS_URL="https://idprep.kuveytturk.com.tr/api/connect/token";t.FX_CURRENCY_LIST="https://apitest.kuveytturk.com.tr/prep/v1/data/fecs";t.FX_CURRENCY_RATES="https://apitest.kuveytturk.com.tr/prep/v1/fx/rates";t.KUVEYT_TURK_BRANCHES="https://apitest.kuveytturk.com.tr/prep/v1/data/branches";t.KUVEYT_TURK_ATMS="https://apitest.kuveytturk.com.tr/prep/v1/data/atms";t.KUVEYT_TURK_XTMS="https://apitest.kuveytturk.com.tr/prep/v1/data/xtms";t.BANK_LIST="https://apitest.kuveytturk.com.tr/prep/v1/data/banks"}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9rdXZleXR0dXJrLWFwaS93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8va3V2ZXl0dHVyay1hcGkvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8va3V2ZXl0dHVyay1hcGkvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8va3V2ZXl0dHVyay1hcGkvLi9zcmMva3V2ZXl0dHVya0FwaS5qcyIsIndlYnBhY2s6Ly9rdXZleXR0dXJrLWFwaS8uL3NyYy9hcGlIZWxwZXIuanMiLCJ3ZWJwYWNrOi8va3V2ZXl0dHVyay1hcGkvLi9zcmMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8va3V2ZXl0dHVyay1hcGkvZXh0ZXJuYWwgXCJjcnlwdG9cIiIsIndlYnBhY2s6Ly9rdXZleXR0dXJrLWFwaS8uL3NyYy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8va3V2ZXl0dHVyay1hcGkvLi9zcmMvY29uZmlnLmpzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsInNlbGYiLCJ0aGlzIiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIl9rdXZleXR0dXJrQXBpIiwiSGVscGVyIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJDb25maWciLCJDTElFTlRfSUQiLCJDTElFTlRfU0VDUkVUIiwiUFJJVkFURV9LRVkiLCJrdXZleXR0dXJrQXBpIiwiY2xpZW50X2lkIiwiY2xpZW50X3NlY3JldCIsInJlZGlyZWN0X3VyaSIsInByaXZhdGVfa2V5IiwiX2NsYXNzQ2FsbENoZWNrIiwiX3RoaXMiLCJpc1ZhbGlkVG9rZW4iLCJ0b2tlbiIsIlByb21pc2UiLCJyZXNvbHZlIiwiYWNjZXNzX3Rva2VuIiwic2NvcGVMaXN0IiwicHVzaCIsInJlcXVlc3QiLCJwcmVwYXJlQ2xpZW50Q3JlZGVudGlhbHNSZXF1ZXN0IiwicmVqZWN0IiwiZmV0Y2hCb2R5IiwicHJlcGFyZUZldGNoIiwiZmV0Y2giLCJDTElFTlRfQ1JFREVOVElBTFNfVVJMIiwidGhlbiIsInJlc3BvbnNlIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImpzb24iLCJkYXRhIiwiZXhwaXJlc0luIiwiZXhwaXJlc19pbiIsInJlY2VpdmVkVGltZSIsIkRhdGUiLCJub3ciLCJzZW5kR2VuZXJhbEdldFJlcXVlc3QiLCJGWF9DVVJSRU5DWV9SQVRFUyIsIl90aGlzMiIsImdldENyZWRlbnRpYWxzVG9rZW4iLCJwcmVwYXJlR2VuZXJhbFJlcXVlc3QiLCJib2R5IiwiS1VWRVlUX1RVUktfQlJBTkNIRVMiLCJfdGhpczMiLCJLVVZFWVRfVFVSS19BVE1TIiwiX3RoaXM0IiwiS1VWRVlUX1RVUktfWFRNUyIsIl90aGlzNSIsIkJBTktfTElTVCIsImJhbmtJZCIsImNpdHlJZCIsIl90aGlzNiIsImFwaVVybCIsInF1ZXJ5IiwiZnVsbFVybCIsInVybCIsIl90aGlzNyIsImNsaWVudElkIiwic2VjcmV0SWQiLCJoZWFkZXJzIiwic2NvcGUiLCJfdXRpbHMiLCJhcnJheVRvU3RyaW5nIiwiYXNzaWduIiwiQ29udGVudC1UeXBlIiwiX2NvbnN0YW50cyIsIlVSTF9FTkNPREVEX1RZUEUiLCJKU09OX3RvX1VSTEVuY29kZWQiLCJwcml2YXRlS2V5IiwiZ2V0U2Vjb25kc0JldHdlZW5EYXRlcyIsIkpTT04iLCJzdHJpbmdpZnkiLCJBdXRob3JpemF0aW9uIiwiU2lnbmF0dXJlIiwiZ2VuZXJhdGVTaWduYXR1cmUiLCJtZXRob2QiLCJsaXN0IiwicmVzdWx0IiwiZm9yRWFjaCIsIml0ZW0iLCJzdWJzdHIiLCJsZW5ndGgiLCJlbGVtZW50IiwiX3R5cGVvZiIsImlkeCIsImVuY29kZVVSSUNvbXBvbmVudCIsImpvaW4iLCJlbmNyeXB0ZWRUZXh0Iiwic2lnbiIsImNyeXB0byIsImNyZWF0ZVNpZ24iLCJ3cml0ZSIsImVuZCIsImRhdGUxIiwiZGF0ZTIiLCJyZXF1aXJlIiwiQVBJX0JBU0VfVVJMIiwiSURFTlRJVFlfQkFTRV9VUkwiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBQ0EsaUJBQUFDLFNBQUEsaUJBQUFDLE9BQ0FBLE9BQUFELFFBQUFELElBQ0EsbUJBQUFHLGVBQUFDLElBQ0FELE9BQUEsb0JBQUFILEdBQ0EsaUJBQUFDLFFBQ0FBLFFBQUEsa0JBQUFELElBRUFELEVBQUEsa0JBQUFDLElBUkEsQ0FTQyxvQkFBQUssVUFBQUMsS0FBQSxXQUNELG1CQ1RBLElBQUFDLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQVIsUUFHQSxJQUFBQyxFQUFBSyxFQUFBRSxHQUFBLENBQ0FDLEVBQUFELEVBQ0FFLEdBQUEsRUFDQVYsUUFBQSxJQVVBLE9BTkFXLEVBQUFILEdBQUFJLEtBQUFYLEVBQUFELFFBQUFDLElBQUFELFFBQUFPLEdBR0FOLEVBQUFTLEdBQUEsRUFHQVQsRUFBQUQsUUEwREEsT0FyREFPLEVBQUFNLEVBQUFGLEVBR0FKLEVBQUFPLEVBQUFSLEVBR0FDLEVBQUFRLEVBQUEsU0FBQWYsRUFBQWdCLEVBQUFDLEdBQ0FWLEVBQUFXLEVBQUFsQixFQUFBZ0IsSUFDQUcsT0FBQUMsZUFBQXBCLEVBQUFnQixFQUFBLENBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDVixFQUFBZ0IsRUFBQSxTQUFBdkIsR0FDQSxvQkFBQXdCLGVBQUFDLGFBQ0FOLE9BQUFD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QixRQUFTekMsRUFBUXlDLHlHQ2hEdEIsU0FBdUJpQixHQUcxQixJQUFJQyxFQUFRLEdBS1osT0FKQUQsRUFBS0UsUUFBUSxTQUFBQyxHQUNURixHQUFVRSxFQUFPLE1BRXJCRixFQUFTQSxFQUFPRyxPQUFPLEVBQUdILEVBQU9JLE9BQU8seUJBSXJDLFNBQVNkLEVBQW1CZSxFQUFROUYsRUFBSXdGLEdBQzNDQSxFQUFPQSxHQUFRLEdBQ2YsR0FBb0IsVUFBakJPLEVBQU9ELEdBQ1IsSUFBSyxJQUFJRSxLQUFPRixFQUNkZixFQUFtQmUsRUFBUUUsR0FBS2hHLEVBQUlBLEVBQUksSUFBSWdHLEVBQUksSUFBSUEsRUFBSVIsUUFFMURBLEVBQUszRCxLQUFLN0IsRUFBSSxJQUFJaUcsbUJBQW1CSCxJQUV2QyxPQUFPTixFQUFLVSxLQUFLLDBCQUdkLFNBQTJCMUUsRUFBTTZCLEVBQUsyQixFQUFXZixHQUVwRCxJQUFJa0MsRUFBZ0IzRSxFQUFNNkIsRUFDdkJZLElBRUNrQyxHQUFpQmxDLEdBRXJCLElBQUltQyxFQUFPQyxFQUFPQyxXQUFXLGNBSTdCLE9BSEFGLEVBQUtHLE1BQU1KLEdBQ1hDLEVBQUtJLE1BQ1dKLEVBQUtBLEtBQUtwQixFQUFZLG9DQUtuQyxTQUFnQ3lCLEVBQU1DLEdBRXpDLEdBQUdELEVBQU1DLEVBRUwsT0FBUUQsRUFBTUMsR0FBTyxJQUd6QixPQUFRQSxFQUFNRCxHQUFPLEtBOUN6QixJQUFBSix5U0FBQTFGLENBQUFwQyxFQUFBLHlQQ0RBTixFQUFBRCxRQUFBMkksUUFBQSxzSUNDK0IsMFRDREUsbUNBQzFCLElBQU1DLEVBQWUsbUZBQ1VDLHdFQUNORCwwRUFDQ0EsNEVBQ0dBLDZFQUNKQSx5RUFDQUEsa0VBQ1BBIiwiZmlsZSI6Imt1dmV5dHR1cmstYXBpLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwia3V2ZXl0dHVyay1hcGlcIiwgW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wia3V2ZXl0dHVyay1hcGlcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wia3V2ZXl0dHVyay1hcGlcIl0gPSBmYWN0b3J5KCk7XG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiaW1wb3J0IEt1dmV5dHR1cmtBcGkgZnJvbSAnLi9rdXZleXR0dXJrQXBpJztcclxuZXhwb3J0IHsgS3V2ZXl0dHVya0FwaSB9O1xyXG4iLCJpbXBvcnQgKiBhcyBIZWxwZXIgZnJvbSAnLi9hcGlIZWxwZXInXHJcbmltcG9ydCAqIGFzIENvbmZpZyBmcm9tICcuL2NvbmZpZyc7XHJcblxyXG52YXIgQ0xJRU5UX0lEID0gJyc7XHJcbnZhciBDTElFTlRfU0VDUkVUID0gJyc7XHJcbi8vdmFyIFJFRElSRUNUX1VSSSA9ICcnO1xyXG52YXIgUFJJVkFURV9LRVkgPSAnJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGt1dmV5dHR1cmtBcGkge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGNsaWVudF9pZCwgY2xpZW50X3NlY3JldCwgcmVkaXJlY3RfdXJpLCBwcml2YXRlX2tleSkge1xyXG4gICAgICAgIENMSUVOVF9JRCA9IGNsaWVudF9pZDtcclxuICAgICAgICBDTElFTlRfU0VDUkVUID0gY2xpZW50X3NlY3JldDtcclxuICAgICAgIC8vIFJFRElSRUNUX1VSSSA9IHJlZGlyZWN0X3VyaTtcclxuICAgICAgICBQUklWQVRFX0tFWSA9IHByaXZhdGVfa2V5OyAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q3JlZGVudGlhbHNUb2tlbigpIHtcclxuICAgICAgICBpZihIZWxwZXIuaXNWYWxpZFRva2VuKHRoaXMudG9rZW4pKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7IHJlc29sdmUodGhpcy50b2tlbi5hY2Nlc3NfdG9rZW4pfSlcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNjb3BlTGlzdCA9IFtdO1xyXG4gICAgICAgIHNjb3BlTGlzdC5wdXNoKCdwdWJsaWMnKTtcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IEhlbHBlci5wcmVwYXJlQ2xpZW50Q3JlZGVudGlhbHNSZXF1ZXN0KHNjb3BlTGlzdCwgQ0xJRU5UX0lELCBDTElFTlRfU0VDUkVUKTtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgZmV0Y2hCb2R5ID0gSGVscGVyLnByZXBhcmVGZXRjaChyZXF1ZXN0KTtcclxuICAgICAgICAgICAgZmV0Y2goQ29uZmlnLkNMSUVOVF9DUkVERU5USUFMU19VUkwsIGZldGNoQm9keSkuXHJcbiAgICAgICAgICAgICAgICB0aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZS5zdGF0dXNUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuanNvbigpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b2tlbiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRva2VuLmFjY2Vzc190b2tlbiA9IGRhdGEuYWNjZXNzX3Rva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRva2VuLmV4cGlyZXNJbj0gZGF0YS5leHBpcmVzX2luXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9rZW4ucmVjZWl2ZWRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhLmFjY2Vzc190b2tlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBmeEN1cnJlbmN5TGlzdCgpIHtcclxuICAgICAgICByZXR1cm4gXHJcbiAgICB9XHJcblxyXG4gICAgZnhDdXJyZW5jeVJhdGVzKCkge1xyXG4gICAgICAgcmV0dXJuIHRoaXMuc2VuZEdlbmVyYWxHZXRSZXF1ZXN0KENvbmZpZy5GWF9DVVJSRU5DWV9SQVRFUyk7XHJcbiAgICB9XHJcblxyXG4gICAga3V2ZXl0VHVya0JyYW5jaExpc3QoKVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0Q3JlZGVudGlhbHNUb2tlbigpLnRoZW4oKHRva2VuKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYm9keTtcclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gSGVscGVyLnByZXBhcmVHZW5lcmFsUmVxdWVzdCh0b2tlbixib2R5LFBSSVZBVEVfS0VZKTtcclxuICAgICAgICAgICAgICAgIHZhciBmZXRjaEJvZHkgPSBIZWxwZXIucHJlcGFyZUZldGNoKHJlcXVlc3QpO1xyXG4gICAgICAgICAgICAgICAgZmV0Y2goQ29uZmlnLktVVkVZVF9UVVJLX0JSQU5DSEVTLCBmZXRjaEJvZHkpLlxyXG4gICAgICAgICAgICAgICAgICAgIHRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2Uuc3RhdHVzVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuanNvbigpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGt1dmV5dFR1cmtBdG1MaXN0KClcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmdldENyZWRlbnRpYWxzVG9rZW4oKS50aGVuKCh0b2tlbikgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGJvZHk7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IEhlbHBlci5wcmVwYXJlR2VuZXJhbFJlcXVlc3QodG9rZW4sYm9keSxQUklWQVRFX0tFWSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmV0Y2hCb2R5ID0gSGVscGVyLnByZXBhcmVGZXRjaChyZXF1ZXN0KTtcclxuICAgICAgICAgICAgICAgIGZldGNoKENvbmZpZy5LVVZFWVRfVFVSS19BVE1TLCBmZXRjaEJvZHkpLlxyXG4gICAgICAgICAgICAgICAgICAgIHRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2Uuc3RhdHVzVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuanNvbigpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBrdXZleXRUdXJrWHRtTGlzdCgpXHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5nZXRDcmVkZW50aWFsc1Rva2VuKCkudGhlbigodG9rZW4pID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciBib2R5O1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBIZWxwZXIucHJlcGFyZUdlbmVyYWxSZXF1ZXN0KHRva2VuLGJvZHksUFJJVkFURV9LRVkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZldGNoQm9keSA9IEhlbHBlci5wcmVwYXJlRmV0Y2gocmVxdWVzdCk7XHJcbiAgICAgICAgICAgICAgICBmZXRjaChDb25maWcuS1VWRVlUX1RVUktfWFRNUywgZmV0Y2hCb2R5KS5cclxuICAgICAgICAgICAgICAgICAgICB0aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlLnN0YXR1c1RleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBiYW5rTGlzdCgpXHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5nZXRDcmVkZW50aWFsc1Rva2VuKCkudGhlbigodG9rZW4pID0+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciBib2R5O1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBIZWxwZXIucHJlcGFyZUdlbmVyYWxSZXF1ZXN0KHRva2VuLGJvZHksUFJJVkFURV9LRVkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZldGNoQm9keSA9IEhlbHBlci5wcmVwYXJlRmV0Y2gocmVxdWVzdCk7XHJcbiAgICAgICAgICAgICAgICBmZXRjaChDb25maWcuQkFOS19MSVNULCBmZXRjaEJvZHkpLlxyXG4gICAgICAgICAgICAgICAgICAgIHRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2Uuc3RhdHVzVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuanNvbigpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGJhbmtCcmFuY2hMaXN0KGJhbmtJZCwgY2l0eUlkKVxyXG4gICAge1xyXG4gICAgICAgIHZhciBhcGlVcmwgPSBDb25maWcuQkFOS19MSVNUICsgJy8nK2JhbmtJZCsnL2JyYW5jaGVzJztcclxuICAgICAgICB2YXIgcXVlcnkgPSAnP2NpdHlJZD0nK2NpdHlJZDtcclxuICAgICAgICB2YXIgZnVsbFVybCA9IGFwaVVybCArIHF1ZXJ5O1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0Q3JlZGVudGlhbHNUb2tlbigpLnRoZW4oKHRva2VuKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYm9keTtcclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gSGVscGVyLnByZXBhcmVHZW5lcmFsUmVxdWVzdCh0b2tlbixib2R5LFBSSVZBVEVfS0VZLHF1ZXJ5KTtcclxuICAgICAgICAgICAgICAgIHZhciBmZXRjaEJvZHkgPSBIZWxwZXIucHJlcGFyZUZldGNoKHJlcXVlc3QpO1xyXG4gICAgICAgICAgICAgICAgZmV0Y2goZnVsbFVybCwgZmV0Y2hCb2R5KS5cclxuICAgICAgICAgICAgICAgICAgICB0aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlLnN0YXR1c1RleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBzZW5kR2VuZXJhbEdldFJlcXVlc3QodXJsLHF1ZXJ5KVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0Q3JlZGVudGlhbHNUb2tlbigpLnRoZW4oKHRva2VuKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYm9keTtcclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gSGVscGVyLnByZXBhcmVHZW5lcmFsUmVxdWVzdCh0b2tlbixib2R5LFBSSVZBVEVfS0VZLHF1ZXJ5KTtcclxuICAgICAgICAgICAgICAgIHZhciBmZXRjaEJvZHkgPSBIZWxwZXIucHJlcGFyZUZldGNoKHJlcXVlc3QpO1xyXG4gICAgICAgICAgICAgICAgZmV0Y2godXJsLCBmZXRjaEJvZHkpLlxyXG4gICAgICAgICAgICAgICAgICAgIHRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2Uuc3RhdHVzVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuanNvbigpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59XHJcbiIsIlxyXG5pbXBvcnQgeyBhcnJheVRvU3RyaW5nLCBKU09OX3RvX1VSTEVuY29kZWQsIGdlbmVyYXRlU2lnbmF0dXJlICwgZ2V0U2Vjb25kc0JldHdlZW5EYXRlcyB9IGZyb20gJy4vdXRpbHMnO1xyXG5pbXBvcnQgeyBVUkxfRU5DT0RFRF9UWVBFfSBmcm9tICcuL2NvbnN0YW50cyc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcHJlcGFyZUNsaWVudENyZWRlbnRpYWxzUmVxdWVzdChzY29wZUxpc3QsIGNsaWVudElkLCBzZWNyZXRJZCkge1xyXG4gICAgdmFyIHJlcXVlc3QgPSB7XHJcbiAgICAgICAgYm9keTogJycsXHJcbiAgICAgICAgaGVhZGVyczoge31cclxuICAgIH07XHJcbiAgICB2YXIgYm9keSA9IHt9O1xyXG4gICAgYm9keS5ncmFudF90eXBlID0gXCJjbGllbnRfY3JlZGVudGlhbHNcIjtcclxuICAgIGJvZHkuc2NvcGUgPSBhcnJheVRvU3RyaW5nKHNjb3BlTGlzdCk7XHJcbiAgICBib2R5LmNsaWVudF9pZCA9IGNsaWVudElkO1xyXG4gICAgYm9keS5jbGllbnRfc2VjcmV0ID0gc2VjcmV0SWQ7XHJcbiAgICByZXF1ZXN0LmhlYWRlcnMgPSBPYmplY3QuYXNzaWduKHt9LCByZXF1ZXN0LmhlYWRlcnMgLCB7J0NvbnRlbnQtVHlwZSc6IFVSTF9FTkNPREVEX1RZUEV9KVxyXG4gICAgcmVxdWVzdC5ib2R5ID0gSlNPTl90b19VUkxFbmNvZGVkKGJvZHkpO1xyXG4gICAgcmV0dXJuIHJlcXVlc3Q7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwcmVwYXJlR2VuZXJhbFJlcXVlc3QodG9rZW4sYm9keSxwcml2YXRlS2V5LHF1ZXJ5KVxyXG57XHJcbiAgICB2YXIgcmVxdWVzdCA9IHtcclxuICAgICAgICBib2R5IDogJycsXHJcbiAgICAgICAgaGVhZGVyczoge31cclxuICAgIH07XHJcbiAgICByZXF1ZXN0LmJvZHkgPSBcIlwiO1xyXG4gICAgaWYoYm9keSlcclxuICAgIHtcclxuICAgICAgICByZXF1ZXN0LmJvZHkgPSBKU09OLnN0cmluZ2lmeShib2R5KTtcclxuICAgIH1cclxuICAgIHJlcXVlc3QuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnK3Rva2VuO1xyXG4gICAgcmVxdWVzdC5oZWFkZXJzLlNpZ25hdHVyZSA9IGdlbmVyYXRlU2lnbmF0dXJlKHRva2VuLHJlcXVlc3QuYm9keSxwcml2YXRlS2V5LHF1ZXJ5KTsgICAgXHJcbiAgICByZXF1ZXN0LmhlYWRlcnMgPSBPYmplY3QuYXNzaWduKHt9LCByZXF1ZXN0LmhlYWRlcnMsIHtcclxuICAgICAgICAnQ29udGVudC1UeXBlJyA6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gcmVxdWVzdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHByZXBhcmVGZXRjaChyZXF1ZXN0KSB7XHJcbiAgICBpZiAocmVxdWVzdC5ib2R5KSB7XHJcblxyXG4gICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywgLy8gJ0dFVCcsICdQVVQnLCAnREVMRVRFJywgZXRjLlxyXG4gICAgICAgICAgICBib2R5OiByZXF1ZXN0LmJvZHksIC8vIENvb3JkaW5hdGUgdGhlIGJvZHkgdHlwZSB3aXRoICdDb250ZW50LVR5cGUnXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHJlcXVlc3QuaGVhZGVyc1xyXG4gICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJywgLy8gJ0dFVCcsICdQVVQnLCAnREVMRVRFJywgZXRjLiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBoZWFkZXJzOiByZXF1ZXN0LmhlYWRlcnMsXHJcbiAgICAgICAgICB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2VuZEdlbmVyYWxHZXRSZXF1ZXN0KHByaXZhdGVLZXksdXJsLGdldENyZWRlbnRpYWxzVG9rZW4pXHJcbntcclxuICAgIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBnZXRDcmVkZW50aWFsc1Rva2VuKCkudGhlbigodG9rZW4pID0+XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgYm9keTtcclxuICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBwcmVwYXJlR2VuZXJhbFJlcXVlc3QodG9rZW4sYm9keSxwcml2YXRlS2V5KTtcclxuICAgICAgICAgICAgdmFyIGZldGNoQm9keSA9IHByZXBhcmVGZXRjaChyZXF1ZXN0KTtcclxuICAgICAgICAgICAgZmV0Y2godXJsLCBmZXRjaEJvZHkpLlxyXG4gICAgICAgICAgICAgICAgdGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2Uuc3RhdHVzVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkVG9rZW4odG9rZW4pXHJcbntcclxuICAgIGlmKCF0b2tlbilcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICB2YXIgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgIGlmKGdldFNlY29uZHNCZXR3ZWVuRGF0ZXMobm93LHRva2VuLnJlY2VpdmVkVGltZSk8dG9rZW4uZXhwaXJlc0luKVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG59IiwiXHJcbmltcG9ydCAgKiBhcyBjcnlwdG8gZnJvbSAnY3J5cHRvJ1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5VG9TdHJpbmcobGlzdClcclxue1xyXG5cclxuICAgIHZhciByZXN1bHQgPScnO1xyXG4gICAgbGlzdC5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgIHJlc3VsdCArPSBpdGVtICsgJyAnO1xyXG4gICAgfSk7XHJcbiAgICByZXN1bHQgPSByZXN1bHQuc3Vic3RyKDAsIHJlc3VsdC5sZW5ndGgtMSk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gSlNPTl90b19VUkxFbmNvZGVkKGVsZW1lbnQsa2V5LGxpc3Qpe1xyXG4gICAgbGlzdCA9IGxpc3QgfHwgW107XHJcbiAgICBpZih0eXBlb2YoZWxlbWVudCk9PSdvYmplY3QnKXtcclxuICAgICAgZm9yICh2YXIgaWR4IGluIGVsZW1lbnQpXHJcbiAgICAgICAgSlNPTl90b19VUkxFbmNvZGVkKGVsZW1lbnRbaWR4XSxrZXk/a2V5KydbJytpZHgrJ10nOmlkeCxsaXN0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxpc3QucHVzaChrZXkrJz0nK2VuY29kZVVSSUNvbXBvbmVudChlbGVtZW50KSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbGlzdC5qb2luKCcmJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVNpZ25hdHVyZSh0b2tlbixib2R5LHByaXZhdGVLZXkscXVlcnkpe1xyXG5cclxuICAgIHZhciBlbmNyeXB0ZWRUZXh0ID0gdG9rZW4rYm9keTtcclxuICAgIGlmKHF1ZXJ5KVxyXG4gICAge1xyXG4gICAgICAgIGVuY3J5cHRlZFRleHQgKz0gcXVlcnk7XHJcbiAgICB9XHJcbiAgICB2YXIgc2lnbiA9IGNyeXB0by5jcmVhdGVTaWduKCdSU0EtU0hBMjU2Jyk7XHJcbiAgICBzaWduLndyaXRlKGVuY3J5cHRlZFRleHQpO1xyXG4gICAgc2lnbi5lbmQoKTtcclxuICAgIHZhciBzaWduYXR1cmUgPSBzaWduLnNpZ24ocHJpdmF0ZUtleSwgJ2Jhc2U2NCcpO1xyXG4gICAgcmV0dXJuIHNpZ25hdHVyZTtcclxuXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTZWNvbmRzQmV0d2VlbkRhdGVzKGRhdGUxLGRhdGUyKVxyXG57XHJcbiAgICBpZihkYXRlMT5kYXRlMilcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gKGRhdGUxLWRhdGUyKS8xMDAwO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAoZGF0ZTItZGF0ZTEpLzEwMDA7XHJcbn1cclxuIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiY3J5cHRvXCIpOyIsIlxyXG5leHBvcnQgY29uc3QgVVJMX0VOQ09ERURfVFlQRT0gXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIjsiLCJleHBvcnQgY29uc3QgSURFTlRJVFlfQkFTRV9VUkwgPSAnaHR0cHM6Ly9pZHByZXAua3V2ZXl0dHVyay5jb20udHInO1xyXG5leHBvcnQgY29uc3QgQVBJX0JBU0VfVVJMID0gJ2h0dHBzOi8vYXBpdGVzdC5rdXZleXR0dXJrLmNvbS50ci9wcmVwJztcclxuZXhwb3J0IGNvbnN0IENMSUVOVF9DUkVERU5USUFMU19VUkwgPSBJREVOVElUWV9CQVNFX1VSTCArICcvYXBpL2Nvbm5lY3QvdG9rZW4nO1xyXG5leHBvcnQgY29uc3QgRlhfQ1VSUkVOQ1lfTElTVCA9IEFQSV9CQVNFX1VSTCArICcvdjEvZGF0YS9mZWNzJztcclxuZXhwb3J0IGNvbnN0IEZYX0NVUlJFTkNZX1JBVEVTID0gQVBJX0JBU0VfVVJMICsgJy92MS9meC9yYXRlcyc7XHJcbmV4cG9ydCBjb25zdCBLVVZFWVRfVFVSS19CUkFOQ0hFUyA9IEFQSV9CQVNFX1VSTCArICcvdjEvZGF0YS9icmFuY2hlcyc7XHJcbmV4cG9ydCBjb25zdCBLVVZFWVRfVFVSS19BVE1TID0gQVBJX0JBU0VfVVJMICsgJy92MS9kYXRhL2F0bXMnO1xyXG5leHBvcnQgY29uc3QgS1VWRVlUX1RVUktfWFRNUyA9IEFQSV9CQVNFX1VSTCArICcvdjEvZGF0YS94dG1zJztcclxuZXhwb3J0IGNvbnN0IEJBTktfTElTVCA9IEFQSV9CQVNFX1VSTCArICcvdjEvZGF0YS9iYW5rcyc7XHJcblxyXG4iXSwic291cmNlUm9vdCI6IiJ9